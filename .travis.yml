language: java
jdk:
- oraclejdk8
cache:
  directories:
  - "$HOME/.m2"
sudo: required
services:
- docker
notifications:
  email:
  - ferrero.maurizio84@gmail.com
  on_success: always
  on_failure: always
branches:
  only:
  - master
before_install:
- export BUILD_NAME=$TRAVIS_BRANCH-$(date -u "+%Y%m%d%H%M%S")-$TRAVIS_BUILD_NUMBER
- export DOCKER_USERNAME="drugotosto84"
- export DOCKER_PASSWORD="UfhA2ybn"
script:
- mvn clean package docker:build
- docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
- docker tag drugotosto84/tmx-licensing-service:LocalBuild-Latest drugotosto84/tmx-licensing-service:$BUILD_NAME
- docker push drugotosto84/tmx-licensing-service:$BUILD_NAME
- docker push drugotosto84/tmx-licensing-service:LocalBuild-Latest
- docker tag drugotosto84/tmx-organization-service:LocalBuild-Latest drugotosto84/tmx-organization-service:$BUILD_NAME
- docker push drugotosto84/tmx-organization-service:$BUILD_NAME
- docker push drugotosto84/tmx-organization-service:LocalBuild-Latest
- docker tag drugotosto84/tmx-confsvr:LocalBuild-Latest drugotosto84/tmx-confsvr:$BUILD_NAME
- docker push drugotosto84/tmx-confsvr:$BUILD_NAME
- docker push drugotosto84/tmx-confsvr:LocalBuild-Latest
- docker tag drugotosto84/tmx-eurekasvr:LocalBuild-Latest drugotosto84/tmx-eurekasvr:$BUILD_NAME
- docker push drugotosto84/tmx-eurekasvr:$BUILD_NAME
- docker push drugotosto84/tmx-eurekasvr:LocalBuild-Latest
